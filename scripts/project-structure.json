[
    { "type": "file", "name": ".gitignore", "content": "node_modules\n.DS_Store\ndist\n" },
    {
        "type": "file",
        "name": "background.js",
        "content": "// Background service worker for AI Page Summarizer\nchrome.runtime.onInstalled.addListener(() => {\n    console.log('AI Page Summarizer installed');\n\n    // Set default preferences\n    chrome.storage.sync.set({\n        contentJSEnabled: true,\n        simplifiedMode: false,\n    });\n\n    // Create context menu items\n    chrome.contextMenus.create({\n        id: 'summarizeSelection',\n        title: 'Summarize Selection',\n        contexts: ['selection'],\n    });\n});\n\n// Handle context menu clicks\nchrome.contextMenus.onClicked.addListener((info, tab) => {\n    if (info.menuItemId === 'summarizeSelection') {\n        chrome.tabs.sendMessage(tab.id, { action: 'summarizeSelection', text: info.selectionText });\n    }\n});\n\n// Handle keyboard shortcuts\nchrome.commands.onCommand.addListener((command) => {\n    chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {\n        if (tabs.length === 0) return;\n\n        if (command === 'summarize-selection') {\n            chrome.tabs.sendMessage(tabs[0].id, { action: 'summarizeSelectionCommand' });\n        } else if (command === 'summarize-page') {\n            chrome.tabs.sendMessage(tabs[0].id, { action: 'summarizePageCommand' });\n        }\n    });\n});\n"
    },
    {
        "type": "file",
        "name": "content.css",
        "content": ".ai-summary-extension-icon {\n\tposition: fixed;\n\tbottom: 20px;\n\tright: 20px;\n\twidth: 50px;\n\theight: 50px;\n\tborder-radius: 50%;\n\tbackground-size: cover;\n\tbackground-position: 15px;\n\tbackground-size: 20px;\n\tbackground-repeat: no-repeat;\n\tbackground-color: rgba(255, 255, 255, 0.7);\n\tcursor: pointer;\n\tz-index: 2147483647;\n\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n\ttransition: transform 0.3s ease;\n}\n\n.ai-summary-extension-icon:hover {\n\ttransform: scale(1.1);\n\tbackground-color: rgba(255, 255, 255, 1);\n}\n\n@keyframes ai-summary-pulse {\n\t0% {\n\t\tborder-color: #ff5555;\n\t}\n\n\t50% {\n\t\tborder-color: white;\n\t}\n\n\t100% {\n\t\tborder-color: #ff5555;\n\t}\n}\n\n.ai-summary-banner {\n\tposition: fixed;\n\ttop: -3000px;\n\tright: 20px;\n\tz-index: 9999;\n\tbackground-color: #00BF63;\n\tpadding: 20px;\n\tborder-radius: 10px;\n\ttext-align: center;\n\twidth: 90%;\n\tmax-width: 400px;\n\tbox-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);\n\ttransition: top 0.5s ease;\n}\n\n.ai-summary-banner button.close-button {\n\tposition: absolute;\n\ttop: -9px;\n\tright: -9px;\n\tfont-size: 22px;\n\tfont-weight: bold;\n\tcolor: white;\n\tbackground: black;\n\tborder: none;\n\tcursor: pointer;\n\tborder-radius: 100%;\n\twidth: 32px;\n\theight: 32px;\n\tpadding: 0;\n}\n\n.ai-summary-banner h2 {\n\tmargin-bottom: 10px;\n\tfont-size: 24px;\n\tcolor: white;\n}\n\n.ai-summary-banner p {\n\tfont-size: 16px;\n\tcolor: #f0f0f0;\n}\n\n.ai-summary-banner button.summarize-button {\n\tmargin-top: 15px;\n\tpadding: 10px 20px;\n\tfont-size: 18px;\n\tfont-weight: bold;\n\tcolor: #00BF63;\n\tbackground-color: white;\n\tborder: 2px solid #00BF63;\n\tborder-radius: 5px;\n\tcursor: pointer;\n\tbox-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.ai-summary-checkbox-label {\n\tfont-size: 16px;\n\tcolor: white;\n\tmargin-left: 5px;\n}\n\n.ai-summary-message-bubble {\n\tposition: fixed;\n\tbottom: 70px;\n\tright: 20px;\n\tbackground-color: #00BF63;\n\tcolor: white;\n\tpadding: 10px;\n\tborder-radius: 5px;\n\tbox-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);\n\tz-index: 9998;\n\ttransition: opacity 0.5s ease;\n\topacity: 0;\n\tmax-width: 200px;\n\ttext-align: center;\n}\n\n.ai-summary-loading-container {\n\tposition: fixed;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\twidth: 300px;\n\tpadding: 20px;\n\tbackground: white;\n\tbox-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n\tborder-radius: 8px;\n\ttext-align: center;\n\tz-index: 2147483647;\n}\n\n.ai-summary-loading-bar {\n\theight: 5px;\n\tbackground-color: #007bff;\n\twidth: 0;\n\ttransition: width 0.5s ease-in-out;\n}\n\n.ai-summary-loading-text {\n\tmargin-top: 5px;\n\tcolor: #000000;\n\tfont-size: 16px;\n\tfont-weight: bold;\n}\n\n.ai-summary-container {\n\tposition: fixed;\n\ttop: 100px;\n\tright: 20px;\n\tbackground-color: white;\n\tcolor: #1f243c;\n\tpadding: 20px;\n\tborder: 1px solid #29c4a9;\n\tz-index: 9999;\n\twidth: 90%;\n\tmax-width: 400px;\n\tmargin: 20px auto;\n\tbox-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);\n\tfont-size: 16px;\n\tline-height: 1.5;\n\toverflow-y: auto;\n\tmax-height: calc(100vh - 180px);\n}\n\n.ai-summary-container button.close-button {\n\tposition: absolute;\n\ttop: 2px;\n\tright: 2px;\n\tpadding: 0;\n\tfont-size: 18px;\n\tfont-weight: bold;\n\tcolor: white;\n\tbackground: black;\n\tborder: none;\n\tcursor: pointer;\n\tborder-radius: 100%;\n\twidth: 25px;\n\theight: 25px;\n}\n\n.ai-summary-container::-webkit-scrollbar {\n\twidth: 3px;\n}\n\n.ai-summary-container::-webkit-scrollbar-thumb {\n\tbackground-color: #00bf63;\n}\n\n.ai-summary-error {\n\tcolor: #d32f2f;\n\tpadding: 15px;\n\tmargin: 10px 0;\n\tbackground-color: #ffebee;\n\tborder-radius: 5px;\n\ttext-align: center;\n\tfont-size: 13px;\n}\n\n.ai-summary-retry-btn,\n.ai-summary-alt-btn {\n\tbackground-color: #1976d2;\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 4px;\n\tpadding: 6px 10px;\n\tmargin-top: 10px;\n\tcursor: pointer;\n\tfont-weight: bold;\n\tfont-size: 13px;\n}\n\n.ai-summary-retry-btn:hover,\n.ai-summary-alt-btn:hover {\n\tbackground-color: #1565c0;\n}\n\n.ai-summary-alt-btn {\n\tbackground-color: #689f38;\n\tmargin-left: 8px;\n}\n\n.ai-summary-alt-btn:hover {\n\tbackground-color: #558b2f;\n}\n\n.ai-summary-sidepanel {\n\tposition: fixed;\n\ttop: 0;\n\tright: -350px;\n\twidth: 350px;\n\theight: 100%;\n\theight: -webkit-fill-available;\n\tmax-height: 100%;\n\tmax-height: -webkit-fill-available;\n\tbackground: white;\n\tbox-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);\n\tz-index: 2147483646;\n\ttransition: right 0.3s ease;\n\tdisplay: flex;\n\tflex-direction: column;\n\toverflow: hidden;\n}\n\n.ai-summary-sidepanel-open {\n\tright: 0;\n}\n\n.ai-summary-sidepanel * {\n\tfont-family: inherit;\n}\n\n.ai-summary-sidepanel-header {\n\tpadding: 12px 15px;\n\tbackground: #f5f5f5;\n\tborder-bottom: 1px solid #e0e0e0;\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n}\n\n.ai-summary-sidepanel-header h2 {\n\tmargin: 0;\n\tfont-size: 16px;\n\tfont-weight: 600;\n\tcolor: #333;\n}\n\n.ai-summary-sidepanel-close {\n\tbackground: none;\n\tborder: none;\n\tfont-size: 20px;\n\tline-height: 1;\n\tcursor: pointer;\n\tcolor: #666;\n}\n\n.ai-summary-sidepanel-close:hover {\n\tcolor: #333;\n}\n\n.ai-summary-controls {\n\tpadding: 15px 20px;\n\tborder-bottom: 1px solid #e0e0e0;\n}\n\n.ai-summary-checkbox-container {\n\tmargin-bottom: 15px;\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.ai-summary-checkbox-label {\n\tmargin-left: 8px;\n\tuser-select: none;\n}\n\n.ai-summary-button {\n\tpadding: 10px 15px;\n\tbackground: #2196F3;\n\tcolor: white;\n\tborder: none;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\tfont-weight: 500;\n\twidth: 100%;\n}\n\n.ai-summary-button:hover {\n\tbackground: #1976D2;\n}\n\n.ai-summary-content-container {\n\tpadding: 10px;\n\tflex: 1;\n\toverflow-y: auto;\n\tline-height: 1.6;\n}\n\n.ai-summary-toolbar {\n\tdisplay: flex;\n\talign-items: center;\n\tpadding: 10px 15px;\n\tborder-bottom: 1px solid #e0e0e0;\n\tbackground-color: #f8f8f8;\n}\n\n.ai-summary-toolbar-btn {\n\tpadding: 6px 10px;\n\tmargin-right: 10px;\n\tborder: none;\n\tborder-radius: 4px;\n\tcursor: pointer;\n\tfont-size: 13px;\n\tfont-weight: 500;\n\tdisplay: flex;\n\talign-items: center;\n\ttransition: background-color 0.2s;\n}\n\n.ai-summary-toolbar-btn .btn-icon {\n\tmargin-right: 5px;\n\tfont-size: 14px;\n\tfont-family: 'remixicon';\n}\n\n.ai-summary-toolbar-btn .summarize-btn {\n\tbackground-color: #2196F3;\n\tcolor: white;\n}\n\n.ai-summary-toolbar-btn .summarize-btn:hover {\n\tbackground-color: #1976D2;\n}\n\n.ai-summary-toolbar-btn .copy-btn {\n\tbackground-color: #4CAF50;\n\tcolor: white;\n}\n\n.ai-summary-toolbar-btn .copy-btn:hover {\n\tbackground-color: #388E3C;\n}\n\n.ai-summary-toolbar-btn .copy-btn:disabled {\n\tbackground-color: #a8d0aa;\n\tcursor: not-allowed;\n}\n\n.ai-summary-toggle {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-left: auto;\n}\n\n.toggle-label {\n\tmargin-right: 8px;\n\tfont-size: 13px;\n\tcolor: #666;\n}\n\n.switch {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 40px;\n\theight: 20px;\n}\n\n.switch input {\n\topacity: 0;\n\twidth: 0;\n\theight: 0;\n}\n\n.slider {\n\tposition: absolute;\n\tcursor: pointer;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: #ccc;\n\ttransition: .4s;\n}\n\n.slider:before {\n\tposition: absolute;\n\tcontent: \"\";\n\theight: 16px;\n\twidth: 16px;\n\tleft: 3px;\n\tbottom: 2px;\n\tbackground-color: white;\n\ttransition: .4s;\n}\n\ninput:checked+.slider {\n\tbackground-color: #2196F3;\n}\n\ninput:focus+.slider {\n\tbox-shadow: 0 0 1px #2196F3;\n}\n\ninput:checked+.slider:before {\n\ttransform: translateX(18px);\n}\n\n.slider.round {\n\tborder-radius: 34px;\n}\n\n.slider.round:before {\n\tborder-radius: 50%;\n}\n\n.ai-summary-result {\n\tpadding: 15px;\n\tline-height: 1.6;\n\tfont-size: 14px;\n\tfont-weight: 300;\n}\n\n.ai-summary-result h1,\n.ai-summary-result h2,\n.ai-summary-result h3 {\n\tfont-size: 16px;\n\tmargin: 12px 0 8px;\n\tfont-weight: 500;\n}\n\n.ai-summary-result p {\n\tmargin: 0 0 12px;\n}\n\n/* History styles */\n.ai-summary-history-container {\n\tpadding: 10px;\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 100%;\n}\n\n.ai-summary-history-header {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tmargin-bottom: 15px;\n\tpadding-bottom: 10px;\n\tborder-bottom: 1px solid #e0e0e0;\n}\n\n.ai-summary-history-header h3 {\n\tmargin: 0;\n\tfont-size: 16px;\n\tfont-weight: 600;\n}\n\n.ai-summary-history-back {\n\tbackground: none;\n\tborder: none;\n\tcolor: #2196F3;\n\tcursor: pointer;\n\tpadding: 5px 10px;\n\tfont-size: 14px;\n}\n\n.ai-summary-history-search {\n\tmargin-bottom: 15px;\n\tpadding: 8px 10px;\n\tborder: 1px solid #e0e0e0;\n\tborder-radius: 4px;\n\twidth: 100%;\n\tfont-size: 14px;\n}\n\n.ai-summary-history-list {\n\toverflow-y: auto;\n\tflex: 1;\n}\n\n.ai-summary-history-item {\n\tpadding: 15px;\n\tborder-bottom: 1px solid #f0f0f0;\n\tcursor: pointer;\n\ttransition: background-color 0.2s;\n}\n\n.ai-summary-history-item:hover {\n\tbackground-color: #f5f5f5;\n}\n\n.ai-summary-history-title {\n\tfont-weight: 600;\n\tfont-size: 14px;\n\tmargin-bottom: 5px;\n\twhite-space: nowrap;\n\toverflow: hidden;\n\ttext-overflow: ellipsis;\n}\n\n.ai-summary-history-meta {\n\tfont-size: 12px;\n\tcolor: #888;\n\tmargin-bottom: 8px;\n}\n\n.ai-summary-history-text {\n\tfont-size: 13px;\n\tcolor: #666;\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 2;\n\t-webkit-box-orient: vertical;\n\toverflow: hidden;\n}\n\n.ai-summary-history-empty {\n\ttext-align: center;\n\tpadding: 30px 20px;\n\tcolor: #888;\n\tfont-size: 14px;\n}\n\n.ai-summary-history-view {\n\tpadding: 10px;\n}\n\n.ai-summary-history-meta-container {\n\tmargin-bottom: 20px;\n\tpadding: 10px 0;\n\tborder-bottom: 1px solid #e0e0e0;\n}\n\n.ai-summary-history-view-title {\n\tmargin: 0 0 10px 0;\n\tfont-size: 16px;\n\tfont-weight: 600;\n}\n\n.ai-summary-history-view-date {\n\tfont-size: 13px;\n\tcolor: #666;\n\tmargin-bottom: 5px;\n}\n\n.ai-summary-history-view-url {\n\tfont-size: 12px;\n\tcolor: #2196F3;\n\tword-break: break-all;\n\tdisplay: block;\n}\n"
    },
    {
        "type": "file",
        "name": "content.js",
        "content": "(() => {\n\tlet OPENAI_API_KEY = '';\n\tlet selectedText = '';\n\n\tchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n\t\tconst sidepanel = document.getElementById('ai-summary-sidepanel');\n\n\t\tif (message.action === 'summarizeSelection' && message.text) {\n\t\t\tselectedText = message.text;\n\t\t\tif (sidepanel && !sidepanel.classList.contains('ai-summary-sidepanel-open')) {\n\t\t\t\tsidepanel.classList.add('ai-summary-sidepanel-open');\n\t\t\t\tupdateSidepanelHeight();\n\t\t\t}\n\t\t\tupdateSelectionUI(true);\n\t\t\tsummarizeSelectedText();\n\t\t\tsendResponse({ status: \"selection received\" });\n\t\t} else if (message.action === 'summarizeSelectionCommand') {\n\t\t\tselectedText = window.getSelection().toString().trim();\n\t\t\tif (selectedText) {\n\t\t\t\tif (sidepanel && !sidepanel.classList.contains('ai-summary-sidepanel-open')) {\n\t\t\t\t\tsidepanel.classList.add('ai-summary-sidepanel-open');\n\t\t\t\t\tupdateSidepanelHeight();\n\t\t\t\t}\n\t\t\t\tupdateSelectionUI(true);\n\t\t\t\tsummarizeSelectedText();\n\t\t\t\tsendResponse({ status: \"selection command received\" });\n\t\t\t} else {\n\t\t\t\tdisplayErrorInSidepanel(\"No text selected to summarize.\");\n\t\t\t\tsendResponse({ status: \"no text selected for command\" });\n\t\t\t}\n\t\t} else if (message.action === 'summarizePageCommand') {\n\t\t\tif (sidepanel && !sidepanel.classList.contains('ai-summary-sidepanel-open')) {\n\t\t\t\tsidepanel.classList.add('ai-summary-sidepanel-open');\n\t\t\t\tupdateSidepanelHeight();\n\t\t\t}\n\t\t\tsummarizePage();\n\t\t\tsendResponse({ status: \"page command received\" });\n\t\t}\n\t\treturn true;\n\t});\n\n\tfunction getApiKey() {\n\t\treturn new Promise((resolve) => {\n\t\t\tchrome.storage.sync.get('apiKey', function (data) {\n\t\t\t\tresolve(data.apiKey);\n\t\t\t});\n\t\t});\n\t}\n\n\tchrome.storage.sync.get('contentJSEnabled', function (data) {\n\t\tconst contentJSEnabled = data.contentJSEnabled !== false;\n\t\tif (!contentJSEnabled) return;\n\n\t\tinitUI();\n\t});\n\n\tfunction updateSidepanelHeight() {\n\t\tconst sidepanel = document.getElementById('ai-summary-sidepanel');\n\t\tif (sidepanel && sidepanel.classList.contains('ai-summary-sidepanel-open')) {\n\t\t\tconst windowHeight = window.innerHeight;\n\t\t\tsidepanel.style.height = `${windowHeight - 40}px`;\n\t\t\tsidepanel.style.maxHeight = `${windowHeight - 40}px`;\n\t\t}\n\t}\n\n\tfunction initUI() {\n\t\tconst iconElement = document.createElement('div');\n\t\ticonElement.className = 'ai-summary-extension-icon';\n\t\ticonElement.style.backgroundImage = `url('${chrome.runtime.getURL('icons/icon500.png')}')`;\n\t\tdocument.body.appendChild(iconElement);\n\n\t\tconst sidepanel = createSidepanel();\n\t\tdocument.body.appendChild(sidepanel);\n\n\t\tupdateSidepanelHeight();\n\t\twindow.addEventListener('resize', updateSidepanelHeight);\n\n\t\ticonElement.addEventListener('click', () => {\n\t\t\tsidepanel.classList.toggle('ai-summary-sidepanel-open');\n\t\t\tupdateSidepanelHeight();\n\t\t\tif (sidepanel.classList.contains('ai-summary-sidepanel-open')) {\n\t\t\t\tselectedText = window.getSelection().toString().trim();\n\t\t\t\tupdateSelectionUI(!!selectedText);\n\t\t\t}\n\t\t});\n\n\t\tdocument.getElementById('summarizePageBtn').addEventListener('click', summarizePage);\n\t\tdocument.getElementById('summarizeSelectionBtn').addEventListener('click', summarizeSelectedText);\n\t\tdocument.getElementById('viewHistoryBtn').addEventListener('click', showSummaryHistory);\n\t}\n\n\tdocument.addEventListener('mouseup', function (event) {\n\t\tif (event.target.closest('#ai-summary-sidepanel')) {\n\t\t\treturn;\n\t\t}\n\t\tconst currentSelectedText = window.getSelection().toString().trim();\n\t\tif (currentSelectedText) {\n\t\t\tselectedText = currentSelectedText;\n\t\t}\n\n\t\tconst sidepanel = document.getElementById('ai-summary-sidepanel');\n\t\tif (\n\t\t\tsidepanel?.classList.contains('ai-summary-sidepanel-open')\n\t\t) {\n\t\t\tupdateSelectionUI(!!selectedText);\n\t\t}\n\t});\n\n\tdocument.addEventListener('mousedown', function (e) {\n\t\tconst sidepanel = document.getElementById('ai-summary-sidepanel');\n\t\tif (sidepanel && !e.target.closest('#ai-summary-sidepanel') && !e.target.classList.contains('ai-summary-extension-icon')) {\n\t\t}\n\t});\n\n\tfunction updateSelectionUI(hasSelection) {\n\t\tconst summarizeSelectionButton = document.getElementById('summarizeSelectionBtn');\n\t\tif (summarizeSelectionButton) {\n\t\t\tsummarizeSelectionButton.disabled = !hasSelection;\n\t\t}\n\t}\n\n\tfunction createSidepanel() {\n\t\tconst sidepanel = document.createElement('div');\n\t\tsidepanel.className = 'ai-summary-sidepanel';\n\t\tsidepanel.id = 'ai-summary-sidepanel';\n\n\t\tconst header = document.createElement('div');\n\t\theader.className = 'ai-summary-sidepanel-header';\n\n\t\tconst title = document.createElement('h2');\n\t\ttitle.innerText = 'AI Page Summary';\n\t\theader.appendChild(title);\n\n\t\tconst closeButton = document.createElement('button');\n\t\tcloseButton.className = 'ai-summary-sidepanel-close';\n\t\tcloseButton.innerHTML = '&times;';\n\t\tcloseButton.addEventListener('click', () => {\n\t\t\tsidepanel.classList.remove('ai-summary-sidepanel-open');\n\t\t\tupdateSidepanelHeight();\n\t\t});\n\t\theader.appendChild(closeButton);\n\t\tsidepanel.appendChild(header);\n\n\t\tconst controls = document.createElement('div');\n\t\tcontrols.className = 'ai-summary-controls';\n\n\t\tconst summarizePageBtn = document.createElement('button');\n\t\tsummarizePageBtn.id = 'summarizePageBtn';\n\t\tsummarizePageBtn.className = 'ai-summary-button';\n\t\tsummarizePageBtn.textContent = 'Summarize Page';\n\t\tcontrols.appendChild(summarizePageBtn);\n\n\t\tconst summarizeSelectionBtn = document.createElement('button');\n\t\tsummarizeSelectionBtn.id = 'summarizeSelectionBtn';\n\t\tsummarizeSelectionBtn.className = 'ai-summary-button';\n\t\tsummarizeSelectionBtn.textContent = 'Summarize Selection';\n\t\tsummarizeSelectionBtn.disabled = true;\n\t\tcontrols.appendChild(summarizeSelectionBtn);\n\n\t\tconst viewHistoryBtn = document.createElement('button');\n\t\tviewHistoryBtn.id = 'viewHistoryBtn';\n\t\tviewHistoryBtn.className = 'ai-summary-button';\n\t\tviewHistoryBtn.textContent = 'View History';\n\t\tcontrols.appendChild(viewHistoryBtn);\n\t\tsidepanel.appendChild(controls);\n\n\t\tconst contentContainer = document.createElement('div');\n\t\tcontentContainer.id = 'aiSummaryContent';\n\t\tcontentContainer.className = 'ai-summary-content-container';\n\t\tsidepanel.appendChild(contentContainer);\n\n\t\tconst historyContainer = document.createElement('div');\n\t\thistoryContainer.id = 'aiSummaryHistoryContainer';\n\t\thistoryContainer.className = 'ai-summary-history-container';\n\t\thistoryContainer.style.display = 'none';\n\t\tconst historyHeader = document.createElement('div');\n\t\thistoryHeader.className = 'ai-summary-history-header';\n\t\tconst historyTitle = document.createElement('h3');\n\t\thistoryTitle.textContent = 'Summary History';\n\t\tconst backButton = document.createElement('button');\n\t\tbackButton.className = 'ai-summary-history-back';\n\t\tbackButton.textContent = 'Back to Summary';\n\t\tbackButton.addEventListener('click', () => {\n\t\t\tdocument.getElementById('aiSummaryHistoryContainer').style.display = 'none';\n\t\t\tdocument.getElementById('aiSummaryContent').style.display = 'block';\n\t\t\tdocument.querySelector('.ai-summary-controls').style.display = 'flex';\n\t\t});\n\t\thistoryHeader.appendChild(historyTitle);\n\t\thistoryHeader.appendChild(backButton);\n\t\thistoryContainer.appendChild(historyHeader);\n\t\tconst historyList = document.createElement('div');\n\t\thistoryList.className = 'ai-summary-history-list';\n\t\thistoryContainer.appendChild(historyList);\n\n\t\tsidepanel.appendChild(historyContainer);\n\n\t\treturn sidepanel;\n\t}\n\n\tasync function summarizePage() {\n\t\tOPENAI_API_KEY = await getApiKey();\n\t\tif (!OPENAI_API_KEY) {\n\t\t\tdisplayErrorInSidepanel(\"OpenAI API Key not set. Please configure it in the extension popup.\");\n\t\t\treturn;\n\t\t}\n\t\tdisplayLoadingInSidepanel(\"Summarizing page...\");\n\t\tconsole.log(\"Summarize page called. Implement actual summarization logic here.\");\n\t}\n\n\tasync function summarizeSelectedText() {\n\t\tif (!selectedText) {\n\t\t\tdisplayErrorInSidepanel(\"No text has been selected.\");\n\t\t\treturn;\n\t\t}\n\t\tOPENAI_API_KEY = await getApiKey();\n\t\tif (!OPENAI_API_KEY) {\n\t\t\tdisplayErrorInSidepanel(\"OpenAI API Key not set. Please configure it in the extension popup.\");\n\t\t\treturn;\n\t\t}\n\t\tdisplayLoadingInSidepanel(\"Summarizing selection...\");\n\t\tconsole.log(\"Summarize selected text called. Implement actual summarization logic here.\");\n\t}\n\n\tfunction displaySummaryInSidepanel(html) {\n\t\tconst contentContainer = document.getElementById('aiSummaryContent');\n\t\tconst historyContainer = document.getElementById('aiSummaryHistoryContainer');\n\t\tif (contentContainer) {\n\t\t\tcontentContainer.innerHTML = html;\n\t\t\tcontentContainer.style.display = 'block';\n\t\t}\n\t\tif (historyContainer) {\n\t\t\thistoryContainer.style.display = 'none';\n\t\t}\n\t\tdocument.querySelector('.ai-summary-controls').style.display = 'flex';\n\t}\n\n\tfunction displayErrorInSidepanel(message) {\n\t\tconst contentContainer = document.getElementById('aiSummaryContent');\n\t\tconst historyContainer = document.getElementById('aiSummaryHistoryContainer');\n\t\tif (contentContainer) {\n\t\t\tcontentContainer.innerHTML = `<div class=\"ai-summary-error\">${message}</div>`;\n\t\t\tcontentContainer.style.display = 'block';\n\t\t}\n\t\tif (historyContainer) {\n\t\t\thistoryContainer.style.display = 'none';\n\t\t}\n\t\tdocument.querySelector('.ai-summary-controls').style.display = 'flex';\n\t}\n\n\tfunction displayLoadingInSidepanel(message) {\n\t\tconst contentContainer = document.getElementById('aiSummaryContent');\n\t\tconst historyContainer = document.getElementById('aiSummaryHistoryContainer');\n\t\tif (contentContainer) {\n\t\t\tcontentContainer.innerHTML = `\n                <div class=\"ai-summary-loading-container\">\n                    <div class=\"ai-summary-loading-bar\"></div>\n                    <div class=\"ai-summary-loading-text\">${message}</div>\n                </div>\n            `;\n\t\t\tcontentContainer.style.display = 'block';\n\t\t}\n\t\tif (historyContainer) {\n\t\t\thistoryContainer.style.display = 'none';\n\t\t}\n\t\tdocument.querySelector('.ai-summary-controls').style.display = 'flex';\n\t}\n\n\n\tasync function summarizeWithSimplifiedExtraction() {\n\t\tOPENAI_API_KEY = await getApiKey();\n\t\tif (!OPENAI_API_KEY) {\n\t\t\tconsole.error(\"API Key not found for simplified extraction.\");\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(\"summarizeWithSimplifiedExtraction needs full implementation using API key.\");\n\t}\n\n\tfunction getVisibleText() {\n\t\tlet text = '';\n\t\tconst walker = document.createTreeWalker(\n\t\t\tdocument.body,\n\t\t\tNodeFilter.SHOW_TEXT,\n\t\t\t{\n\t\t\t\tacceptNode: function (node) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tnode.nodeValue.trim() === '' ||\n\t\t\t\t\t\tnode.parentElement.closest('script, style, noscript, iframe, header, footer, nav, aside')\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn NodeFilter.FILTER_REJECT;\n\t\t\t\t\t}\n\t\t\t\t\treturn NodeFilter.FILTER_ACCEPT;\n\t\t\t\t},\n\t\t\t},\n\t\t\tfalse\n\t\t);\n\t\tlet currentNode;\n\t\twhile ((currentNode = walker.nextNode())) {\n\t\t\ttext += currentNode.nodeValue.trim() + ' ';\n\t\t}\n\t\treturn text;\n\t}\n\n\tfunction saveSummaryToHistory(summaryData) {\n\t\tconsole.log(\"saveSummaryToHistory called. Needs full implementation.\");\n\t}\n\n\tfunction showSummaryHistory() {\n\t\tconst contentContainer = document.getElementById('aiSummaryContent');\n\t\tconst historyContainer = document.getElementById('aiSummaryHistoryContainer');\n\t\tconst controlsContainer = document.querySelector('.ai-summary-controls');\n\n\t\tif (contentContainer) contentContainer.style.display = 'none';\n\t\tif (controlsContainer) controlsContainer.style.display = 'none';\n\t\tif (historyContainer) {\n\t\t\thistoryContainer.style.display = 'block';\n\t\t\tconst historyList = historyContainer.querySelector('.ai-summary-history-list');\n\t\t\thistoryList.innerHTML = '<p class=\"ai-summary-history-empty\">History loading/display logic needed here.</p>';\n\t\t}\n\t\tconsole.log(\"showSummaryHistory called. Needs full implementation to load and display history.\");\n\t}\n\n\tfunction showHistorySummary(historyItem) {\n\t\tconsole.log(\"showHistorySummary called. Needs full implementation.\");\n\t}\n})();\n"
    },
    { "type": "directory", "name": "icons", "children": [] },
    {
        "type": "file",
        "name": "manifest.json",
        "content": "{\n    \"name\": \"AI Page Summarizer\",\n    \"version\": \"2.0.0\",\n    \"description\": \"Get quick AI summaries of web pages with a simple click\",\n    \"manifest_version\": 3,\n    \"icons\": {\n        \"16\": \"icons/icon16.png\",\n        \"32\": \"icons/icon32.png\",\n        \"48\": \"icons/icon48.png\",\n        \"128\": \"icons/icon128.png\"\n    },\n    \"action\": {\n        \"default_popup\": \"popup.html\",\n        \"default_icon\": {\n            \"16\": \"icons/icon16.png\",\n            \"32\": \"icons/icon32.png\",\n            \"48\": \"icons/icon48.png\",\n            \"128\": \"icons/icon128.png\"\n        }\n    },\n    \"background\": {\n        \"service_worker\": \"background.js\"\n    },\n    \"permissions\": [\"storage\", \"activeTab\", \"scripting\", \"contextMenus\"],\n    \"host_permissions\": [\"https://*/*\", \"http://*/*\"],\n    \"content_scripts\": [\n        {\n            \"matches\": [\"<all_urls>\"],\n            \"js\": [\"content.js\"],\n            \"css\": [\"content.css\"]\n        }\n    ],\n    \"web_accessible_resources\": [\n        {\n            \"resources\": [\"icons/*.png\", \"fonts/*.woff2\"],\n            \"matches\": [\"<all_urls>\"]\n        }\n    ],\n    \"commands\": {\n        \"summarize-selection\": {\n            \"suggested_key\": {\n                \"default\": \"Alt+S\"\n            },\n            \"description\": \"Summarize selected text\"\n        },\n        \"summarize-page\": {\n            \"suggested_key\": {\n                \"default\": \"Alt+P\"\n            },\n            \"description\": \"Summarize current page\"\n        }\n    }\n}\n"
    },
    {
        "type": "file",
        "name": "package.json",
        "content": "{\n  \"dependencies\": {\n    \"ignore\": \"^7.0.4\"\n  }\n}\n"
    },
    {
        "type": "file",
        "name": "popup.css",
        "content": "@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap');\n@import url('https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css');\n\n* {\n\tmargin: 0;\n\tpadding: 0;\n\tbox-sizing: border-box;\n}\n\nbody {\n\tfont-family: 'Outfit', sans-serif;\n\tbackground-color: #f8f9fa;\n\twidth: 320px;\n\tcolor: #333;\n}\n\n.container {\n\tpadding: 16px;\n}\n\nheader {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 16px;\n\tpadding-bottom: 12px;\n\tborder-bottom: 1px solid #e0e0e0;\n}\n\n.logo {\n\twidth: 32px;\n\theight: 32px;\n\tmargin-right: 12px;\n}\n\nh1 {\n\tfont-size: 18px;\n\tfont-weight: 600;\n\tcolor: #00BF63;\n}\n\n.settings {\n\tmargin-bottom: 16px;\n}\n\n.setting-item {\n\tdisplay: flex;\n\tjustify-content: space-between;\n\talign-items: center;\n\tpadding: 10px 0;\n\tborder-bottom: 1px solid #f0f0f0;\n}\n\n.setting-item span {\n\tfont-size: 14px;\n}\n\n.switch {\n\tposition: relative;\n\tdisplay: inline-block;\n\twidth: 48px;\n\theight: 24px;\n}\n\n.switch input {\n\topacity: 0;\n\twidth: 0;\n\theight: 0;\n}\n\n.slider {\n\tposition: absolute;\n\tcursor: poOutfit;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground-color: #ccc;\n\ttransition: .3s;\n\tborder-radius: 24px;\n}\n\n.slider:before {\n\tposition: absolute;\n\tcontent: \"\";\n\theight: 18px;\n\twidth: 18px;\n\tleft: 3px;\n\tbottom: 3px;\n\tbackground-color: white;\n\ttransition: .3s;\n\tborder-radius: 50%;\n}\n\ninput:checked+.slider {\n\tbackground-color: #00BF63;\n}\n\ninput:focus+.slider {\n\tbox-shadow: 0 0 1px #00BF63;\n}\n\ninput:checked+.slider:before {\n\ttransform: translateX(24px);\n}\n\n.instructions {\n\tbackground-color: #f0f8f4;\n\tpadding: 12px;\n\tborder-radius: 8px;\n\tmargin-bottom: 16px;\n}\n\n.instructions h2 {\n\tfont-size: 14px;\n\tfont-weight: 600;\n\tmargin-bottom: 8px;\n\tcolor: #00BF63;\n}\n\n.instructions p {\n\tfont-size: 13px;\n\tline-height: 1.4;\n\tmargin-bottom: 8px;\n}\n\n.instructions ul {\n\tfont-size: 13px;\n\tpadding-left: 16px;\n\tmargin-bottom: 8px;\n}\n\n.instructions li {\n\tmargin-bottom: 4px;\n}\n\n.status {\n\tpadding: 12px;\n\tborder-radius: 8px;\n\tbackground-color: #f5f5f5;\n\tmargin-bottom: 16px;\n}\n\n.status p {\n\tfont-size: 13px;\n\tline-height: 1.4;\n}\n\n.key-input {\n\tdisplay: flex;\n\tmargin-bottom: 16px;\n}\n\n.key-input input {\n\tflex: 1;\n\tpadding: 8px 12px;\n\tborder: 1px solid #e0e0e0;\n\tborder-radius: 4px;\n\tfont-size: 14px;\n\tmargin-right: 8px;\n}\n\n.key-input button {\n\tpadding: 8px 12px;\n\tbackground-color: #00BF63;\n\tborder: none;\n\tborder-radius: 4px;\n\tcolor: white;\n\tfont-size: 14px;\n\tcursor: poOutfit;\n\ttransition: background-color 0.3s;\n}\n\n.key-input button:hover {\n\tbackground-color: #00a857;\n}\n\n.key-input button:disabled {\n\tbackground-color: #cccccc;\n\tcursor: not-allowed;\n}\n\nfooter {\n\tfont-size: 12px;\n\ttext-align: center;\n\tpadding-top: 12px;\n\tborder-top: 1px solid #e0e0e0;\n\tcolor: #888;\n}\n\nfooter a {\n\tcolor: #00BF63;\n\ttext-decoration: none;\n}\n\nfooter a:hover {\n\ttext-decoration: underline;\n}\n\n.error {\n\tcolor: #e74c3c;\n\tfont-size: 13px;\n\tmargin-top: 4px;\n}\n"
    },
    {
        "type": "file",
        "name": "popup.html",
        "content": "<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <title>AI Page Summarizer</title>\n        <link rel=\"stylesheet\" href=\"popup.css\" />\n    </head>\n    <body>\n        <div class=\"container\">\n            <header>\n                <img src=\"icons/icon128.png\" alt=\"AI Page Summarizer Logo\" class=\"logo\" />\n                <h1>AI Page Summarizer</h1>\n            </header>\n\n            <div class=\"settings\">\n                <div class=\"setting-item\">\n                    <span>Show summarize button</span>\n                    <label class=\"switch\">\n                        <input type=\"checkbox\" id=\"toggleContentJS\" checked />\n                        <span class=\"slider\"></span>\n                    </label>\n                </div>\n\n                <div class=\"setting-item\">\n                    <span>Simplified mode (5th grade level)</span>\n                    <label class=\"switch\">\n                        <input type=\"checkbox\" id=\"simplifiedMode\" />\n                        <span class=\"slider\"></span>\n                    </label>\n                </div>\n            </div>\n\n            <div class=\"key-input\">\n                <input type=\"password\" id=\"apiKey\" placeholder=\"Enter your OpenAI API key\" />\n                <button id=\"saveApiKey\">Save</button>\n            </div>\n            <p class=\"error\" id=\"apiKeyError\"></p>\n\n            <div class=\"instructions\">\n                <h2>How to use:</h2>\n                <ol>\n                    <li>Navigate to any webpage</li>\n                    <li>Click the floating summary icon</li>\n                    <li>Click \"Summarize Page\" in the popup</li>\n                    <li>Read your AI-powered summary!</li>\n                </ol>\n            </div>\n\n            <footer>\n                <p>Version 2.0.0 &copy; 2025</p>\n            </footer>\n        </div>\n        <script src=\"popup.js\"></script>\n    </body>\n</html>\n"
    },
    {
        "type": "file",
        "name": "popup.js",
        "content": "document.addEventListener('DOMContentLoaded', function () {\n    // Get UI elements\n    const toggleContentJS = document.getElementById('toggleContentJS');\n    const simplifiedMode = document.getElementById('simplifiedMode');\n    const apiKeyInput = document.getElementById('apiKey');\n    const saveApiKeyBtn = document.getElementById('saveApiKey');\n    const apiKeyError = document.getElementById('apiKeyError');\n\n    // Load saved preferences from storage\n    chrome.storage.sync.get(['contentJSEnabled', 'simplifiedMode', 'apiKey'], function (data) {\n        // Set toggle switches to saved states (default to true for content toggle)\n        toggleContentJS.checked = data.contentJSEnabled !== false;\n        simplifiedMode.checked = data.simplifiedMode === true;\n\n        // Set API key if it exists\n        if (data.apiKey) {\n            apiKeyInput.value = data.apiKey;\n        }\n    });\n\n    // Add event listeners to save preferences when changed\n    toggleContentJS.addEventListener('change', function () {\n        chrome.storage.sync.set({ contentJSEnabled: this.checked });\n    });\n\n    simplifiedMode.addEventListener('change', function () {\n        chrome.storage.sync.set({ simplifiedMode: this.checked });\n    });\n\n    // Save API key\n    saveApiKeyBtn.addEventListener('click', function () {\n        const apiKey = apiKeyInput.value.trim();\n\n        if (!apiKey) {\n            apiKeyError.textContent = 'Please enter a valid API key';\n            return;\n        }\n\n        // Simple validation - should start with \"sk-\" for OpenAI keys\n        if (!apiKey.startsWith('sk-')) {\n            apiKeyError.textContent = \"This doesn't look like a valid OpenAI API key\";\n            return;\n        }\n\n        // Save API key\n        chrome.storage.sync.set({ apiKey: apiKey }, function () {\n            apiKeyError.textContent = '';\n            apiKeyError.style.color = '#00BF63';\n            apiKeyError.textContent = 'API key saved!';\n\n            // Reset message after 3 seconds\n            setTimeout(() => {\n                apiKeyError.textContent = '';\n            }, 3000);\n        });\n    });\n});\n"
    },
    { "type": "directory", "name": "screenshots", "children": [] }
]
